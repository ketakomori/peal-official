
<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta charset="UTF-8">
<title>peal â€“ layered structure</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>

<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #f2f2f2;
    font-family: Helvetica, Arial, sans-serif;
  }

  #infoLayer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(240,240,240,0.96);
  color: #111;
  padding: 80px;
  box-sizing: border-box;
  overflow-y: auto;
   -webkit-overflow-scrolling: touch; /* iOSã§ãƒŒãƒ«ãƒŒãƒ« */

  z-index: 20;  /* â†è¿½åŠ  */
  opacity: 0;               /* â† é€æ˜ã‚¹ã‚¿ãƒ¼ãƒˆ */
  pointer-events: none;     /* â† ã‚¯ãƒªãƒƒã‚¯ä¸å¯ */
  transition: opacity 0.6s ease;  /* â† ãƒ•ã‚§ãƒ¼ãƒ‰é€Ÿåº¦ */
  }
  #infoLayer.active {
  opacity: 1;
  pointer-events: auto;
  }

  /* INFO å†…ã®ã‚¢ãƒ«ãƒãƒ ã‚¸ãƒ£ã‚±ãƒƒãƒˆ */
.albumArt{
  display: block;
  width: min(320px, 80vw);
  height: auto;
  margin: 24px 0;
}

  #toggleInfo {
    position: fixed;
    top: 20px;
    right: 30px;
    cursor: pointer;
    font-size: 14px;
    letter-spacing: 2px;
    z-index: 10;  /* â†è¿½åŠ  */
    padding: 20px 24px;   /* â† å½“ãŸã‚Šåˆ¤å®šã‚’æ‹¡å¼µ */
    margin: -20px -24px;  /* â† è¦‹ãŸç›®ã®ä½ç½®ã‚’æˆ»ã™ */
  }

 #infoClose {
    position: absolute;
    top: 20px;
    right: 20px;
    font-size: 28px;
    padding: 10px;
    background: none;
    color: #111;   /* â† ä¿®æ­£ */
    border: none;
    cursor: pointer;
  }

  h1 {
    font-weight: 500;
    letter-spacing: 4px;
  }

  p {
    max-width: 700px;
    line-height: 1.8;
  }
</style>
</head>
<body>

<div id="toggleInfo">INFO</div>

<div id="infoLayer">
  <button id="infoClose">Ã—</button>

  <h1>peal</h1>
  <img src="peallogomiddle.jpeg" alt="peal album cover" class="albumArt">
  <p>
  Listen hereâ†“<br><br>
  <a href="https://linkco.re/cZP15Rqx" target="_blank">
  1st Mini Album peal
  </a><br>
  </p>

  <p>peal is a Tokyo-based alternative band since 2024.</p>

  <p>The band explores instability, resonance, and emotional layering through sound
   blending ambient textures, organic noise, and minimal guitar phrases 
   to construct temporary sonic structures that evolve over time.</p>

  <p>Their music focuses on atmosphere rather than genre â€” 
  creating spaces where sound accumulates, collide, and dissolve.</p>

  <p>Each performance is an experiment in balance: 
  how much weight a structure can hold before it begins to tremble.</p>

  <br><br>
  <p>Click anywhere on the screen to layer the sounds.</p>

<hr style="margin:60px 0; border:none; border-top:1px solid #ccc;">

<div id="snsLinks">
  <h3>SNS</h3>
  <div class="sns-item">
    <a href="https://www.instagram.com/peal.band/" target="_blank">Instagram</a>
  </div>
  <div class="sns-item">
    <a href="https://x.com/peal_band" target="_blank">X / Twitter</a>
  </div>
  <div class="sns-item">
    <a href="https://www.youtube.com/@peal_band" target="_blank">YouTube</a>
  </div>
  <div class="sns-item">
    <a href="https://open.spotify.com/intl-ja/artist/7fGy4icSbg4qj8DyGI8PD0" target="_blank">Spotify</a>
  </div>
</div>

</div>

<script>
  
  document.addEventListener("DOMContentLoaded", () => {
  const infoLayer = document.getElementById("infoLayer");
  const toggleInfo = document.getElementById("toggleInfo");
  const infoClose = document.getElementById("infoClose");

  function openInfo(e) {
    e.preventDefault();
    e.stopPropagation();
    infoLayer.classList.add("active");
  }

  function closeInfo(e) {
    e.preventDefault();
    e.stopPropagation();
    infoLayer.classList.remove("active");
  }

  // INFOã‚’é–‹ãï¼ˆiOS Safariå¯¾ç­–ï¼‰
  toggleInfo.addEventListener("touchstart", openInfo, { passive: false });
  toggleInfo.addEventListener("click", openInfo);

  // Ã—ã§é–‰ã˜ã‚‹
  infoClose.addEventListener("touchstart", closeInfo, { passive: false });
  infoClose.addEventListener("click", closeInfo);

});
  

let layers = [];
let currentLayerType = 0;
let players = [];
let layerCount = 0;

function preload() {

  players[0] = new Tone.Player("VSQSE_0037_crowded_street_02.mp3").toDestination();
  players[0].volume.value = -18;  // å°‘ã—ä¸‹ã’ã‚‹

  players[1] = new Tone.Player("hututukaambi1.mp3").toDestination();
  players[1].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[2] = new Tone.Player("hututukariff3.mp3").toDestination();
  players[2].volume.value = -7;  // å°‘ã—ä¸‹ã’ã‚‹

  players[3] = new Tone.Player("hututukajyorin2.mp3").toDestination();
  players[3].volume.value = -17;  // å°‘ã—ä¸‹ã’ã‚‹

  players[4] = new Tone.Player("VSQSE_0046_room_ambient_02.mp3").toDestination();
  players[4].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[5] = new Tone.Player("hututukaambi2.mp3").toDestination();
  players[5].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[6] = new Tone.Player("VSQSE_0546_station_01_ticket_gate.mp3").toDestination();
  players[6].volume.value = -27;  // å°‘ã—ä¸‹ã’ã‚‹

  players[7] = new Tone.Player("hututukaambi3.mp3").toDestination();
  players[7].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[8] = new Tone.Player("hututukastroke.mp3").toDestination();
  players[8].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[9] = new Tone.Player("hututukajyorin2.mp3").toDestination();
  players[9].volume.value = -17;  // å°‘ã—ä¸‹ã’ã‚‹

  players[10] = new Tone.Player("hututukaambi4.mp3").toDestination();
  players[10].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[11] = new Tone.Player("hututukaambi5.mp3").toDestination();
  players[11].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[12] = new Tone.Player("hututukariff2.mp3").toDestination();
  players[12].volume.value = -16;  // å°‘ã—ä¸‹ã’ã‚‹

  players[13] = new Tone.Player("hututukajyorin1.mp3").toDestination();
  players[13].volume.value = -20;  // å°‘ã—ä¸‹ã’ã‚‹

  players[14] = new Tone.Player("hututukaambi3.mp3").toDestination();
  players[14].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹

  players[15] = new Tone.Player("hututukaambi2.mp3").toDestination();
  players[15].volume.value = -2;  // å°‘ã—ä¸‹ã’ã‚‹


  players.forEach(p => {
    p.loop = false;
    
  });
}

let c;
function setup() {
  c = createCanvas(windowWidth, windowHeight);
  // ğŸ‘‡ ã“ã‚ŒãŒé‡è¦
  c.style('position', 'fixed');
  c.style('top', '0');
  c.style('left', '0');
  c.style('z-index', '0');
  background(242);
}

function draw() {
  background(242, 242, 242, 25);

  for (let i = 0; i < layers.length; i++) {
    layers[i].update();
    layers[i].display();
  }
}

async function handleInteraction() {

  // Audioã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç¢ºå®Ÿã«é–‹å§‹
  if (Tone.context.state !== 'running') {
    await Tone.start();
  }

  // éŸ³æºãŒå­˜åœ¨ã™ã‚Œã°å†ç”Ÿ
  if (players[currentLayerType]) {
    players[currentLayerType].start();
  }

  layers.push(new VisualLayer(currentLayerType));
  layerCount++;

  currentLayerType = (currentLayerType + 1) % players.length;
}

function mousePressed() {
  handleInteraction();
}

function touchStarted() {
  const infoLayer = document.getElementById("infoLayer");

  // INFOãŒé–‹ã„ã¦ã‚‹æ™‚ã¯ã€ãƒšãƒ¼ã‚¸å´ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å„ªå…ˆ
  if (infoLayer && infoLayer.classList.contains("active")) {
    return true; // â† é‡è¦ï¼šp5ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’å¥ªã‚ã›ãªã„
  }

  handleInteraction();
  return false; // â† GAMEä¸­ã ã‘ã¯ã“ã‚Œã§OK
}

class VisualLayer {
  constructor(type) {
    // å›è»¢
    this.rotation = random(TWO_PI);
    this.rotationSpeed = random(-0.005, 0.005); 

    this.type = type;

    this.x = random(width);
    this.y = random(height);
    this.size = random(80, 320);

    this.shapeType = floor(random(7));

    // ğŸ¨ ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆï¼ˆRGBï¼‰
    this.palette = [
      [40, 90, 200],    // é’
      [40, 160, 90],    // ç·‘
      [130, 60, 180],   // ç´«
      [230, 140, 40],   // ã‚ªãƒ¬ãƒ³ã‚¸
      [240, 200, 40]    // é»„è‰²
    ];

    // ãƒ©ãƒ³ãƒ€ãƒ ã§1è‰²é¸æŠ
    this.colorPick = random(this.palette);

    this.r = this.colorPick[0];
    this.g = this.colorPick[1];
    this.b = this.colorPick[2];

    this.alpha = random(30, 120);
  
   // ğŸŒŠ ãƒ©ãƒ³ãƒ€ãƒ ç§»å‹•æ–¹å‘
    this.angle = random(TWO_PI);
    this.speed = random(0.1, 0.5);  // ç©ã‚„ã‹ãªç§»å‹•
  }

  update() {
    this.x += cos(this.angle) * this.speed;
    this.y += sin(this.angle) * this.speed;
    this.rotation += this.rotationSpeed;

    // ç”»é¢ç«¯ã§åè»¢ï¼ˆæ¼‚ã„ç¶šã‘ã‚‹ï¼‰
    if (this.x < 0 || this.x > width) {
      this.angle = PI - this.angle;
    }
    if (this.y < 0 || this.y > height) {
      this.angle = -this.angle;
    }
    // ã‚†ã‚‹ã‚„ã‹ãªæ–¹å‘å¤‰åŒ–ï¼ˆã‚ˆã‚Šè‡ªç„¶ã«ï¼‰
  this.angle += random(-0.01, 0.01);

  }

  display() {
  strokeJoin(ROUND);
  strokeCap(ROUND);
  push();

  translate(this.x, this.y);
  rotate(this.rotation);

  if (this.shapeType === 0) {
    noStroke();
    fill(this.r, this.g, this.b, this.alpha);
    ellipse(0, 0, this.size);
  }

  if (this.shapeType === 1) {
    noStroke();
    fill(this.r, this.g, this.b, this.alpha);
    rectMode(CENTER);
    rect(0, 0, this.size, this.size, this.size * 0.3);
  }

  if (this.shapeType === 2) {
    noFill();
    stroke(this.r, this.g, this.b, this.alpha);
    circle(0, 0, this.size);
  }

  if (this.shapeType === 3) {
    noStroke();
    fill(this.r, this.g, this.b, this.alpha);
    triangle(
      -this.size/2, this.size/2,
      this.size/2, this.size/2,
      0, -this.size/2
    );
  }

  if (this.shapeType === 4) {
    stroke(this.r, this.g, this.b, this.alpha);
    line(
      -this.size/2,
      0,
      this.size/2,
      0
    );
  }
  if (this.shapeType === 5) {
  noStroke();
  fill(this.r, this.g, this.b, this.alpha);

  beginShape();
  for (let i = 0; i < 5; i++) {
    let angle = TWO_PI * i / 5 - HALF_PI; 
    let x = cos(angle) * this.size / 2;
    let y = sin(angle) * this.size / 2;
    vertex(x, y);
  }
  endShape(CLOSE);
  }

  if (this.shapeType === 6) {
  noStroke();
  fill(this.r, this.g, this.b, this.alpha);

  beginShape();
  for (let i = 0; i < 7; i++) {
    let angle = TWO_PI * i / 7 - HALF_PI;
    let x = cos(angle) * this.size / 2;
    let y = sin(angle) * this.size / 2;
    vertex(x, y);
  }
  endShape(CLOSE);
}

  pop();
}

}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
}

</script>

</body>
</html>
